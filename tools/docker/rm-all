#!/bin/sh
#
# rm-all -- remove all docker labs
#

export RELEASE=0

read -p 'This command is dangerous, are you sure? (yes/no) ' sure

[ "x$sure" != 'xyes' ] && exit 0

TOP_DIR=$(cd $(dirname $0)/../../ && pwd)
. $TOP_DIR/tools/docker/config $* >/dev/null

for name in `docker ps -a --format='{{.Names}}'`
do
    notify_user 2 "Lab will be removed " ${name%-*}

    LOCAL_DESKTOP_SHORTCUT=~/Desktop/${name}.desktop
    [ -f $LOCAL_DESKTOP_SHORTCUT ] && rm -f $LOCAL_DESKTOP_SHORTCUT
done

docker ps -a --format='{{.ID}}' | xargs -I{} docker rm -f {} 2>&1

$DOCKER_RELEASE_CMD all >/dev/null 2>&1

rm -rf $RELEASE_FILE
